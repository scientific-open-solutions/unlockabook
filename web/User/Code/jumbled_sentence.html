<!--
  Jumbled sentence questions
  
-->
<style>
.question_box{
  width: 400px;
  height: 250px;
  text-align: center;
  line-height: 200px;
  font-size: 25px;
  border-radius: 15px;
}
#sentence_html{
  margin:auto;
  width:500px;
  padding:50px;
  max-height:600px;
  text-align: center;  
}
</style>
<table id = "questionTable">
  <tr>
    <td><div class="question_box" id="box_0"></div></td>
  </tr>
</table>

<div id="sentence_html" class="form-inline">


<script>
// var select = document.getElementById("selectAnswer");
// var options1 = ["Golgi tendon organs", "muscles", "tendons", "muscles"];
// for(var i = 0; i < options1.length; i++) {
    // var opt = options1[i];
    // var dropDown = document.createElement("option");
    // dropDown.textContent = opt;
    // dropDown.value = opt;
    // select.appendChild(dropDown);
// }
/*
var allQuestions = [
  {
    question: "The " + "<select id = 'selectAnswer'</select>" + " are at the junction between " + "<select id = 'selectAnswer'</select>" + " and " + "<select id = 'selectAnswer'</select>" + ", they signal forces imposed on, or generated by, the " + "<select id = 'selectAnswer'</select>" + ".",
    answers: ["Golgi tendon organs", "muscles", "tendons", "muscles"]
  }
];
*/

if(typeof(parent.parent.exp_json.all_stims["{{jumbled}}"]) !== "undefined"){
  var raw_questions = Trial.get_stim("{{jumbled}}");
  console.log("raw_questions");
  console.log(raw_questions);
  var long_questions = Papa.parse(raw_questions,{
    header: true
  }).data;
  
  console.dir("long_questions");
  console.log(long_questions);
  
  /*
  * group the items together to make each sentence - based on https://stackoverflow.com/a/35092559/4490801
  */ 
  var sentence_numbers = [...new Set(long_questions.map(item => item.sentence))];
  
  console.dir("howdy");
  
  allQuestions = [];
  sentence_numbers.forEach(function(sentence_number){
    var this_sentence = long_questions.filter(row => row.sentence == sentence_number);
    allQuestions.push(this_sentence);
  });
  
  
} else {
  var allQuestions = [
    [
      {
        type: "text",
        content: "The "
      },{
        type: "dropdown",
        content: "--Please Select--,Golgi tendon organs,muscles,tendons,muscles"
      },  
    ],
    [
      {
        type: "text",
        content: "The "
      },{
        type: "dropdown",
        content: "--Please Select--,Golgi tendon organs,muscles,tendons,muscles"
      },  
    ]
  ];
 
}



var this_question = allQuestions[0];  
var question = this_question.map(function(sentence_part, index){
  console.dir(sentence_part);
  if(sentence_part.type == "text"){
    return sentence_part["content"];
  } else {
    sentence_part.content = sentence_part.content.split(",");
    return "<select class='form-control' style='width:auto'> <option>" + sentence_part.content.join("</option><option>") + "</option> </select><br>";
  }
});

$("#sentence_html").html(question.join(""));


/*


var question = allQuestions.map(function(card, index){
  if(card.type == "text"){
    return card["sentence"][content];
    return "allQuestions[sentence][content]";
  } else {
    return "<select> <option>" + card.content + "</option> </select><br>";
  }

});
$(".question_box").html(question);
*/


// var currentQuestion = 0;
// var question = allQuestions.map(function(card, index){
//   return "<button onClick='loadCard(this.id)' class='btn btn-primary card_btn' data-bs-toggle='button' autocomplete='off' id=" + index + ">" + card.answers + "</button><br>";
// });
// $("#selectAnswer").html(answers);
// var this_question = allQuestions[currentQuestion]["answers"];
// $(".question_box").html(this_question);

</script>
